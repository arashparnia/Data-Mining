---
title: "R Notebook"
output: html_notebook
---
delete all 
```{r}
# Data loading
rm(list=ls())
```

# Load libraries
```{r}
library("ggplot2")
# install.packages("nortest")
library(nortest)
#install.packages("mvoutlier")
library(mvoutlier)
#install.packages("doBy")
library(doBy)
# install.packages("anytime")
library(anytime)
```

# Load rawdata set
```{r}
load("../../../Data/rawdata_environment.RData")
```
# load from data set and save to r object
```{r}
# rawdata <- read.csv("../../../Data/training_set_VU_DM_2014.csv", header= TRUE)
# save.image("../../../Data/rawdata_environment.RData")

```
# make envorument file from rdata
```{r}
# load(file = "../../../Data/data_Pclass1.RData")
# load(file = "../../../Data/data_Pclass2.RData")
# load(file = "../../../Data/data_Pclass3.RData")
# load(file = "../../../Data/data_Pclass4.RData")
# load(file = "../../../Data/data_Pclass5.RData")
# load(file = "../../../Data/data_Pclass6.RData")

# load(file = "../../../Data/dataTEST_Pclass1.RData")
# load(file = "../../../Data/dataTEST_Pclass2.RData")
# load(file = "../../../Data/dataTEST_Pclass3.RData")
# load(file = "../../../Data/dataTEST_Pclass4.RData")
# load(file = "../../../Data/dataTEST_Pclass5.RData")
# load(file = "../../../Data/dataTEST_Pclass6.RData")


# save.image("../../../Data/rawdata_environment.RData")

```

# Save Data files In RData
```{r}
# save(Data_Pclass1,file = "data_Pclass1.RData")
# save(Data_Pclass2,file = "data_Pclass2.RData")
# save(Data_Pclass3,file = "data_Pclass3.RData")
# save(Data_Pclass4,file = "data_Pclass4.RData")
# save(Data_Pclass5,file = "data_Pclass5.RData")
# save(Data_Pclass6,file = "data_Pclass6.RData")
# save(Data_Pclass7,file = "data_Pclass7.RData")
```

<!-- # Save Data files In RData -->
<!-- ```{r} -->
<!-- write.csv(Data_Pclass1,file = "datacsv_Pclass1.csv") -->
<!-- write.csv(Data_Pclass2,file = "datacsv_Pclass2.csv") -->
<!-- write.csv(Data_Pclass3,file = "datacsv_Pclass3.csv") -->
<!-- write.csv(Data_Pclass4,file = "datacsv_Pclass4.csv") -->
<!-- write.csv(Data_Pclass5,file = "datacsv_Pclass5.csv") -->
<!-- write.csv(Data_Pclass6,file = "datacsv_Pclass6.csv") -->
<!-- write.csv(Data_Pclass7,file = "datacsv_Pclass7.csv") -->
<!-- ``` -->



# changing name for 
```{r}
colnames(df)[which(names(df) == "price_usd_normalized.prices_normalized")] <- "price_usd_normalized"
df$price_usd_normalized <-  df$price_usd_normalized$prices_normalized
names(df)
```

#removing all columns with NA 
```{r}

df <- Data_Pclass1
df$consumer < - as.factor(df$consumer)

df <- df[ , colSums(is.na(df)) == 0]
#An alternative way is to use apply:
# df <- df[ , apply(df, 2, function(x) !any(is.na(x)))]
```

#all data converted to facotr
```{r}
df <- as.factor(df)
```


#Boruta
Limitations
Some limitations of the Boruta package are worth highlighting:

It only works with classification (factor) target variables. I am not sure why: as far as I remember, the random forest algorithm also provides a variable significance score when it is used as a predictor, not just when it is run as a classifier.
It does not handle missing (NA) values at all. This is quite a problem when working with real data sets, and a shame as random forests are in principle very good at handling missing values. A simple re-write of the package using the party package instead of randomForest should be able to fix this issue.
It does not seem to be completely stable. I have crashed it on several real-world data sets and am working on a minimal set to send to the authors.


```{r}
library(Boruta)

# sample_data <- df[sample(nrow(df), 100), ]
df <- as.factor(df)
b <- Boruta(df$score, df, doTrace = 2)

print(b)
```





#random forest
```{r}
library(randomForest)
fit_randomForest_1 <- randomForest(score ~ 
                                  # srch_id + 
                                  # date_time + 
                                  # site_id + 
                                  # visitor_location_country_id + 
                                  # visitor_hist_starrating + 
                                  # prop_country_id +                       
                                  # prop_id + 
                                  # prop_starrating + 
                                  # prop_review_score + 
                                  # prop_brand_bool + 
                                  # prop_location_score1 + 
                                  # prop_location_score2 + 
                                  # prop_log_historical_price + 
                                  # position + 
                                  # promotion_flag + 
                                  # srch_destination_id + 
                                  # srch_length_of_stay + 
                                  # srch_booking_window + 
                                  # srch_adults_count + 
                                  # srch_children_count +                 
                                  # srch_room_count + 
                                  # srch_saturday_night_bool + 
                                  price_usd_normalized +
                                  
                      ,
                      data=df, 
                      importance=TRUE, 
                      ntree=2000)





```



















